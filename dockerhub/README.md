# Dockerhub Webhook Sample

This sample integration showcases Release triggers for Dockerhub push webhook events.

The preferred approach of using this sample is by applying the `webhook-integration.yaml` as-code template as described
in the main README file.

After applying the YAML file you can test it using the `Test run` feature on the trigger configuration page.

Push request events can be tested using `push_request.json`.

The sample YAML file will configure the following objects in Release under the *Webhook Samples* folder:
 - Single endpoint for all events from Dockerhub accessible from **http://&lt;xlr-address&gt;/webhooks/dockerhub-sample-webhook**
 - Trigger to handle push events
   - This trigger has been configured to use the visual rule editor.  It checks the event payload to ensure it is only executed 
   when pushing to the repository xlrelease/xlr-dockerhub-webhook.
 - Template that the trigger uses to create releases with a number of release variables that will be populated by the
   triggers

## Configure Dockerhub to send webhook events to Digital.AI Release

In Dockerhub go to the repository you want to enable the webhook events for and navigate to the *Webhooks* tab.

For the Webhook name field enter a descriptive name for this Webhook.

For the Webhook URL field use the endpoint created in Release, in this case **http://&lt;xlr-address&gt;/webhooks/dockerhub-sample-webhook**.

Then click on *Create* to create the Webhook.  Now the webhook is enabled and should send an event to the
endpoint configured in Release when a container is pushed to the repo.

More information can be found in the [Dockerhub documentation](https://docs.docker.com/docker-hub/webhooks/).

### Troubleshooting webhooks from Dockerhub

You can view the history of Webhooks generated by Dockerhub for each configure repository.

In Dockerhub go to the repository that contains the webhook and navigate to the Webhooks tab.  At the bottom of the
page is a list of webhooks for the project.  Select the three vertical dots icon to the right of the configured Webhook and 
select *View History*.  

#### Customizing the YAML file for your environment

The sample here works in a Dockerhub environment configured with:
 * repository *xlrelease/xlr-dockerhub-webhook*

Look for those values in the YAML file and adjust according to your environment.


